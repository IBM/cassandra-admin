<!DOCTYPE html>
<html x-data="{ darkMode: localStorage.getItem('darkMode') || localStorage.setItem('darkMode', 'system')}" x-init="$watch('darkMode', val => localStorage.setItem('darkMode', val))">
<head>
  <meta charset="UTF-8">
  <title>{{ config.app_name }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>[x-cloak] { display: none !important; }</style>
  {% if constants.feature_flags.enable_htmx then %}
  <script src="https://unpkg.com/htmx.org@1.9.12"></script>
  <script>
  htmx.on("htmx:beforeSwap", () => {Alpine.deferMutations()})
  htmx.on("htmx:afterSettle", () => {Alpine.flushAndStopDeferringMutations()})
  </script>
  {% end %}
  <style>
    body {
      font-size: 0.875rem !important;
    }
  </style>
</head>

<body :data-bs-theme="darkMode === 'dark' || (darkMode === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches) ? 'dark' : 'light'" {% if constants.feature_flags.enable_htmx then %} hx-boost="true" {% end %}>
{% if os.getenv("CA_DEBUG_MODE") == "true" then %}<div class="badge bg-body-secondary opacity-50 position-fixed text-body-tertiary text-uppercase top-0 user-select-none z-3">Debug Mode</div>{% end %}
{*view*}
</body>
</html>
